<!DOCTYPE html>
<html>
<head>
    <title>Debug ‚Äì U√±a seleccionada + XAI</title>
    <style>
        body { font-family: Arial; padding: 20px; }
        h2 { margin-top: 30px; }
        .grid {
            display: flex;
            gap: 40px;
            align-items: flex-start;
        }
        .item {
            border: 1px solid #ccc;
            padding: 20px;
            border-radius: 10px;
            width: 320px;
        }
        img {
            width: 280px;
            border-radius: 8px;
            margin-bottom: 10px;
            background: #f2f2f2; /* üëâ Fondo gris claro detr√°s de negro */
        }
        textarea {
            width: 100%;
            height: 160px;
        }
        .small {
            opacity: 0.7;
            font-size: 14px;
        }
    </style>
</head>
<body>

<h1>Debug ‚Äì U√±a seleccionada + Grad-CAM++</h1>

<p>Pega aqu√≠ el JSON completo retornado por <code>/predict-hand</code>:</p>

<textarea id="jsonInput" placeholder="Pega aqu√≠ tu JSON..."></textarea>
<br><br>
<button onclick="mostrar()">Mostrar im√°genes</button>

<hr>

<div id="output"></div>

<script>
function mostrar() {
    const text = document.getElementById("jsonInput").value;
    let data = null;

    try {
        data = JSON.parse(text);
    } catch (e) {
        alert("JSON inv√°lido");
        return;
    }

    const out = document.getElementById("output");
    out.innerHTML = ""; 

    if (!data.selected_nail) {
        out.innerHTML = "<p>No existe 'selected_nail' en la respuesta.</p>";
        return;
    }

    const crop = data.selected_nail.crop_image_base64;
    const xai = data.selected_nail_xai;

    const prob = data.probability?.toFixed(4) ?? "N/A";
    const area = data.selected_nail.area ?? "N/A";
    const sharp = data.selected_nail.sharpness?.toFixed(2) ?? "N/A";
    const score = data.selected_nail.score?.toFixed(2) ?? "N/A";

    const html = `
        <div class="grid">
            <div class="item">
                <h2>üü© U√±a seleccionada</h2>
                <img src="data:image/jpeg;base64,${crop}">
                <p class="small"><b>Probabilidad modelo:</b> ${prob}</p>
                <p class="small"><b>√Årea:</b> ${area}</p>
                <p class="small"><b>Nitidez:</b> ${sharp}</p>
                <p class="small"><b>Score selecci√≥n:</b> ${score}</p>
            </div>

            <div class="item">
                <h2>üî• Grad-CAM++</h2>
                ${xai
                    ? `<img src="data:image/jpeg;base64,${xai}">`
                    : "<p>No XAI generado (usa xai=true).</p>"
                }
            </div>
        </div>
    `;

    out.innerHTML = html;
}
</script>

</body>
</html>
